---
sidebar_position: 3
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# One-To-Many Relationship

In sequelize, One-To-Many relationships are defined using [`HasMany`](pathname:///api/classes/Model.html#hasMany) & [`BelongsTo`](pathname:///api/classes/Model.html#belongsTo) associations.

## Philosophy

[**Resource: About One-To-Many Relationships**](https://en.wikipedia.org/wiki/One-to-many_%28data_model%29)

One-To-Many relationships are connecting one source with multiple targets, while all these targets are connected only with this single source.

This means that, unlike the One-To-One relationship, in which we had to choose where the foreign key would be placed, there is only one option in One-To-Many relationship.
For example, if one Foo has many Bars (and this way each Bar belongs to one Foo), then the only sensible implementation is to have a `fooId` column in the `Bar` table.
The opposite is impossible, since one Foo has many Bars.

## In practice

For the rest of this example, let's assume that we have two models, `Team` and `Player`.

We want to tell Sequelize that there is a One-To-Many relationship between them, meaning that one Team has many Players,
while each Player belongs to a single Team.

To create this relationship, the `hasMany` and `belongsTo` associations are used together:

```javascript
// SourceModel.hasMany(TargetModel) adds the foreignKey on TargetModel
Team.hasMany(Player);

// SourceModel.belongsTo(TargetModel) adds the foreignKey on SourceModel
Player.belongsTo(Team);
```

Calling [`sequelize.sync()`](pathname:///api/classes/Sequelize.html#sync) after the above will execute the following SQL:

```sql
-- dialect: PostgreSQL
CREATE TABLE IF NOT EXISTS "Teams" (
  /* ... */
);

CREATE TABLE IF NOT EXISTS "Players" (
  /* ... */
  "TeamId" INTEGER REFERENCES "Teams" ("id") ON DELETE SET NULL ON UPDATE CASCADE,
  /* ... */
);
```

### Options

[//]: # (TODO: expand this section!)

The list of available options are mostly the same as the ones in [One-To-One relationships](./one-to-one.mdx#options).

:::info

All options for `Model.hasMany` are documented in the [API Reference for `HasManyOptions`](pathname:///api/interfaces/HasManyOptions.html)

All options for `Model.belongsTo` are documented in the [API Reference for `BelongsToOptions`](pathname:///api/interfaces/BelongsToOptions.html)

:::

## Model Association Methods

### `hasMany`

Calling `SourceModel.hasMany(TargetModel)` adds a series of Association-related methods to the source Model.

The name of these methods is dynamically generated based on the name of the association.

<Tabs>
<TabItem value="ts" label="TypeScript">

```typescript
import { HasManyGetAssociationsMixin, HasManyAddAssociationMixin, HasManyAddAssociationsMixin, HasManySetAssociationsMixin, HasManyRemoveAssociationMixin, HasManyRemoveAssociationsMixin, HasManyHasAssociationMixin, HasManyHasAssociationsMixin, HasManyCountAssociationsMixin, HasManyCreateAssociationMixin, InferAttributes, InferCreationAttributes, Model } from '@sequelize/core';

class Team extends Model<InferAttributes<Team>, InferCreationAttributes<Team>> {
  // These methods will be added by Team.hasMany(Player)
  // Declare their typings like this:

  // returns the list of players associated to this instance
  declare getPlayers: HasManyGetAssociationsMixin<Player>;

  // associates a single player to this instance
  declare addPlayer: HasManyAddAssociationMixin<Player, Player['id']>;

  // associates multiple players to this instance
  declare addPlayers: HasManyAddAssociationsMixin<Player, Player['id']>;

  // replaces all players associated to this instance
  declare setPlayers: HasManySetAssociationsMixin<Player, Player['id']>;

  // dissociates a single player from this instance
  declare removePlayer: HasManyRemoveAssociationMixin<Player, Player['id']>;

  // dissociates a set of player from this instance
  declare removePlayers: HasManyRemoveAssociationsMixin<Player, Player['id']>;

  // returns whether the player is associated to this instance
  declare hasPlayer: HasManyHasAssociationMixin<Player, Player['id']>;

  // returns whether all player in the set are associated to this instance
  declare hasPlayers: HasManyHasAssociationsMixin<Player, Player['id']>;

  // counts how many players are associated to this instance
  declare countPlayers: HasManyCountAssociationsMixin;

  // creates a new Player entity and associates it to this instance
  declare createPlayer: HasManyCreateAssociationMixin<Player, 'TeamId'>;

  // The 'TeamId' foreign key has been added on Player, and must not be declared here.
}

Team.init(/* options */);

Team.hasMany(Player);
```

</TabItem>
<TabItem value="js" label="JavaScript (CJS)">

```typescript
import { Model } from '@sequelize/core';

class Team extends Model {}

Team.init(/* options */);

// this adds a foreign key 'TeamId' on Player
// it also adds the following instance methods:
//
// - getPlayers: returns the list of players associated to the Team instance
// - addPlayer: associates a single player to the Team instance
// - addPlayers: associates multiple players to the Team instance
// - setPlayers: replaces all players associated to the Team instance
// - removePlayer: dissociates a single player from the Team instance
// - removePlayers: dissociates a set of player from the Team instance
// - hasPlayer: returns whether the player is associated to the Team instance
// - hasPlayers: returns whether all player in the set are associated to the Team instance
// - countPlayers: counts how many players are associated to the Team instance
// - createPlayer: creates a new Player entity and associates it to the Team instance
Team.hasMany(Player);
```

</TabItem>
</Tabs>

### `belongsTo`

import BelongsToMethods from './_belongs-to-methods.mdx';

<BelongsToMethods />

## Querying

The getter method (e.g. `getPlayers`) functions identically to other entity finder methods (such as `findAll`).
[Read more about how to query associations here](../querying/associations.mdx).
